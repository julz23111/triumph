<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Library System</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="theme-color" content="#0f172a">
  <link rel="preload" href="styles.css" as="style">
  <noscript><style>.container{display:none}</style><div style="padding:1rem;font-family:system-ui, -apple-system, Segoe UI, Roboto;">JavaScript is required to use the Library System. Please enable JavaScript.</div></noscript>
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ“š Library System</h1>
      <a href="/admin/" class="admin-link">Admin Dashboard</a>
    </header>

    <div id="alerts" aria-live="polite" style="display:none" class="alert"></div>

    <div class="tabs" role="tablist">
      <button class="tab-btn active" role="tab" data-tab="add-book">Add Book</button>
      <button class="tab-btn" role="tab" data-tab="checkout">Check Out</button>
      <button class="tab-btn" role="tab" data-tab="browse">Browse Books</button>
    </div>

    <!-- Add Book Tab -->
    <div class="tab-content active" id="add-book">
      <h2>Add Book to Library</h2>
      <p class="info">Take a photo of a book to add it to the library database</p>
      
      <div class="camera-section">
        <input type="file" id="add-book-input" accept="image/*" capture="environment" style="display: none;">
        <button class="btn btn-primary" onclick="document.getElementById('add-book-input').click()">
          ðŸ“· Take Photo
        </button>
        <div id="add-book-preview" class="image-preview"></div>
        <p id="add-book-fileinfo" class="hint" style="display:none"></p>
        <p class="hint">Accepted: JPG/PNG. Up to ~10 MB per image. Clear, upright spines work best.</p>
      </div>

      <button id="analyze-btn" class="btn btn-success" style="display: none;">
        Analyze & Add Book
      </button>

      <div id="add-book-result" class="result"></div>
    </div>

    <!-- Checkout Tab -->
    <div class="tab-content" id="checkout">
      <h2>Check Out a Book</h2>
      <p class="info">Enter your name and select a book or take a photo</p>
      
      <div class="form-group">
        <label for="user-name">Your Name:</label>
        <input type="text" id="user-name" placeholder="Enter your name" class="input-field">
      </div>

      <div class="form-group">
        <label>Choose an option:</label>
        <div class="checkout-options">
          <button class="btn btn-secondary" id="select-existing-btn">
            ðŸ“– Select from Library
          </button>
          <button class="btn btn-secondary" id="photo-checkout-btn">
            ðŸ“· Take Photo
          </button>
        </div>
      </div>

      <div id="book-select-section" style="display: none;">
        <label for="book-select">Select Book:</label>
        <select id="book-select" class="input-field">
          <option value="">-- Select a book --</option>
        </select>
        <p class="hint">Tip: You can also take a photo of the spine instead.</p>
      </div>

      <div class="camera-section" id="checkout-camera-section" style="display: none;">
        <input type="file" id="checkout-book-input" accept="image/*" capture="environment" style="display: none;">
        <button class="btn btn-primary" onclick="document.getElementById('checkout-book-input').click()">
          ðŸ“· Take Photo
        </button>
        <div id="checkout-book-preview" class="image-preview"></div>
      </div>

      <button id="checkout-btn" class="btn btn-success" style="display: none;">
        Check Out Book
      </button>

      <div id="checkout-result" class="result"></div>
    </div>

    <!-- Browse Books Tab -->
    <div class="tab-content" id="browse">
      <h2>Library Books</h2>
      <div id="books-list" class="books-list"></div>
    </div>
  </div>

  <div id="loading" class="loading" style="display:none" aria-hidden="true"></div>

  <!-- Templates used by app.js -->
  <template id="book-card-template">
    <div class="book-card">
      <div class="book-title"></div>
      <div class="book-author"></div>
      <div class="book-meta"></div>
    </div>
  </template>

  <template id="loading-template">
    <div class="spinner"></div>
    <p>Processing...</p>
  </template>

  <script type="module" src="app.js"></script>
</body>
</html>
